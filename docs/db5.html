<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Data model | Gauquelin5</title>
    <link href="static/gauquelin5.css" rel="stylesheet" type="text/css">
    <meta name="description" content="">
    <meta name="robots" content="index,follow">
    <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
    <meta name="dcterms.rights" content="Creative commons by-sa 4.0">
    <meta name="dcterms.rightsHolder" content="Thierry Graff">
    <meta name="dcterms.dateCopyrighted" content="2019">
    <!-- 
    tigsite:
        history: 2019-12-21 00:37:21+01:00, Thierry Graff : Creation
    -->
</head>

<body>
<div class="container">

<div class="main">

<a name="topage"></a>
<nav class="prevnext">
    <a class="topage" rel="" href="#topage">&#10148;</a>
    <a class="top" href="index.html">&uarr;</a>
    <a class="prev" rel="prev" href="organisation.html">&larr;</a>
    <a class="next" rel="next" href="output-format.html">&rarr;</a>
</nav>

<header>
<h1>
Gauquelin5 database
<div class="subtitle">(db5)</div>
</h1>
<div class="intro">
Gauquelin5 database is used to merge the data manipulated by g5 ; it contains the notions of <b>Source</b>, <b>Person</b>, <b>Group</b>.
<!-- 
Gauquelin5 database contains the notions of <a href="db5-source.html"><b>Source</b></a>, <a href="db5-person.html"><b>Person</b></a>, <a href="db5-group.html"><b>Group</b></a>.
-->
</div>
</header>

<article>
<nav class="toc">
    <ul>
        <li>
            <a href="#flow">Flow</a>
        </li>
        <li>
            <a href="#data-model">Data model</a>
        </li>
        <li>
            <a href="#syntax">Syntax</a>
        </li>
        <li>
            <a href="#person">Person</a>
        </li>
        <li>
            <a href="#implementation-details">Implementation details</a>
        </li>
    </ul>
</nav>


<!-- ********************************************************************************* -->
<h2><a name="flow">Flow</a></h2>
<img class="border margin padding" src="img/db5-flow.svg" alt="">


<!-- ********************************************************************************* -->
<h2><a name="data-model">Data model</a></h2>
<div class="float-left">
    <img class="border margin padding" src="img/db5-model.svg" alt="">
</div>

<div class="small8 float-left margin">
Read :
<br>
<ul class="naked border inline-block padding05 margin05">
    <li>
        1 source is related to 0 or more persons
        <br>0 => a source can exist without being related to any person.
    </li>
    <li class="padding-top05">
        1 person is related to 1 or more sources
        <br>1 => a person cannot exist in the database without being related to a source.
    </li>
</ul>
</div>
<br class="clear-left">

<ul class="spaced">
    <li>
        <div class="bold">Source</div>
        <!-- <div class="bold"><a href="db5-source.html">Source</a></div> -->
        Information sources, origin of the data manipulated by g5.
        <br>The link between Source and Source permits to handle the notion of parent source.
        <br>For example, the source called <code>A1</code> refers to the html web page <a href="http://cura.free.fr/gauq/902gdA1y.html">cura.free.fr/gauq/902gdA1y.html</a>
        <br><code>A1</code> has a parent source called <code>cura</code>, which refers to web site <a href="http://cura.free.fr">cura.free.fr</a>.
        <br>One source can have several parents.
    </li>
    <li>
        <div class="bold">Person</div>
        <!-- <div class="bold"><a href="db5-person.html">Person</a></div> -->
        Famous people who are studied.
    </li>
    <li>
        <div class="bold">Group</div>
        <!-- <div class="bold"><a href="db5-group.html">Group</a></div> -->
        A set of persons
        <br>The link between Group and Group permits to handle the notion of sub-group.
        <br>One group can be sub-group of several groups.
    </li>
    <li>
        <div class="bold">Occupation</div>
        <!-- <div class="bold"><a href="db5-occu.html">Occupation</a></div> -->
        Activity of a person, ~profession
        <br>The link between Occupation and Occupation permits to classify occupations.
        <br>For example, a poet is also an artist.
    </li>
    
</ul>


<!-- ********************************************************************************* -->
<h2><a name="syntax">Syntax</a></h2>
The definitions of the fields are expressed in yaml files located with the source code of the model
<pre>
src/model/
    ├── Group.php
    ├── Group.yml
    ├── Person.php
    ├── Person.yml
    ├── Source.php
    └── Source.yml
</pre>

For example, file <code>Person.yml</code> contains an empty person with all its fields empty.
<br>This provides to the code a precise definition of the entities, used as the description of a new type.

<br><br>All entities of this database have a field called <b>slug</b>, unique within each entity type.

<!-- ********************************************************************************* -->
<h2><a name="person">Person</a></h2>

The structure of a person is given by <code>src/model/Person.yml</code>
<pre>
slug:

to-check:         # true or false - related to field "notes"

trust:
trust-details: []

sources: []
# key / value pairs
# key = source slug ; value = local id in the given source
ids-in-sources: []

sex:

name:
  usual:
  given:
  family:
  spouse:
  official:                 # As written in the birth certificate
    family:
    given:
  nobiliary-particle: false # de d' di del von...
  fame:                     # stage, scene
  nicknames: []
  alternative: []

# occupation codes
occus: []

birth:
  date:     # exact date (day and hour) of the birth certificate
  tzo:      # timezone offset
  date-ut:  # date converted to Univesal Time
  note:     # eg "LMT"
  place:
    name:
    c2:
    c3:
    cy:
    geoid:
    lg:
    lat:
      
death:
  date:     # exact date of the birth certificate
  tz:       # timezone offset
  date-ut:  # date converted to Univesal Time
  note:     # eg "LMT"
  place:
    name:
    c2:
    c3:
    cy:
    geoid:
    lg:
    lat:

notes: []   # array of free notes

raw: []

history: []
</pre>


<!-- ********************************************************************************* -->
<h2><a name="implementation-details">Implementation details</a></h2>
The database uses <a href="https://www.postgresql.org/">postgresql</a>.
<br>Structured fields are stored using <a href="https://www.postgresql.org/docs/12/datatype-json.html">jsonb</a> type. 
<br>
<br>Each entity has a field <code>id</code>, used as primary key.


</article>
</div><!-- end class="main" -->

<!-- ************************************* -->
<aside class="left">                                                                                                                                              
<ul>
    <li class="bold big1"><a href="https://github.com/tig12/gauquelin5">Code repository</a></li>
    <li class="bold big1"><a href="index.html">Home</a></li>
    
    <li><a href="usage.html">Program usage</a></li>
    <li><a href="organisation.html">Organisation</a></li>
    <li><a href="db5.html">G5 database</a></li>
    <li><a href="output-format.html">Output format</a></li>
    
    <li class="bold big1"><a href="https://larzac.info/gauquelin5">Download results</a></li>
    
    <li>
        <span class="big1">1 - Restore</span>                            
        <ul>
        
            <li><a href="historical-tests.html"><b>Historical tests</b></a></li>
            
            <li><a href="cura.html">cura.free.fr</a></li>
            
            <li>
                <ul>
                    <a href="cura-A.html">A</a>
                    <a href="cura-D6.html">D6</a>
                    <a href="cura-D10.html">D10</a>
                    <a href="cura-E1-E3.html">E1 E3</a>
                </ul>
            </li>
            
            <li>
                <a href="newalch.html">newalchemypress.com</a>
                <ul>
                    <li><a href="newalch-ertel4391.html">Ertel 4391 athletes</a></li>
                    <li><a href="newalch-muller1083.html">Müller 1083 physicians</a></li>
                    <li><a href="newalch-muller402.html">Müller 402 writers</a></li>
                </ul>
            </li>
            
            
            <li>
                <a href="g55.html">Gauquelin 1955</a>
                <ul>
                    <li><a href="g55-restore.html">Restoration</a></li>
                    <li><a href="g55-curadiff.html">Differences with Cura</a></li>
                </ul>
            </li>
            
            <li><a href="comite-para.html">Comité Para 1976</a></li>
            <li><a href="csicop.html">CSICOP 1979</a></li>
            <li><a href="cfepp.html">CFEPP 1996</a></li>
            <!-- <li><a href="todo-data.html">Data TODO</a></li> -->
        </ul>
    </li>
    
    <li>
        <span class="big1">2 - Build new data</span>
        <ul>
            <!-- <li><a href="full.html">7-full</a></li> -->
            <li><a href="check.html">Check</a></li>
            <li><a href="acts.html">Acts</a></li>
            <li><a href="wikidata.html">Wikidata.org</a></li>
            <li><a href="geonames.html">Geonames.org</a></li>
        </ul>
    </li>
        
    <li>
        <span class="big1">3 - Eminence</span>
        <ul>
            <li><a href="eminence.html">Eminence ranking</a></li>
            <!-- 
            <li><a href="maths.html">Mathemeticians</a></li>
            -->
        </ul>
    </li>
    
    <li>
        <span class="big1">Details</span>
        <ul>
            <li><a href="time.html">Time and timezone</a></li>
            <li><a href="tweak2tmp.html">tweak2tmp</a></li>
            <li><a href="code-details.html">Code details</a></li>
        </ul>
    </li>
    
    <!-- <li><a href="next.html">Next</a></li> -->
    
    <!-- <li><a href="questions.html">Questions</a></li> -->

</ul>
</aside>

</div><!-- end class="container" -->

</body>
</html>
