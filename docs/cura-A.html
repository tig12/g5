<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>A | Gauquelin5</title>
    <link href="static/gauquelin5.css" rel="stylesheet" type="text/css">
    <meta name="description" content="Conversion of cura.free.fr html pages to csv for files of serie A">
    <meta name="robots" content="index,follow">
    <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
    <meta name="dcterms.rights" content="Creative commons by-sa 4.0">
    <meta name="dcterms.rightsHolder" content="Thierry Graff">
    <meta name="dcterms.dateCopyrighted" content="2019">
    <!-- 
    tigsite:
        history: 2019-04-02 03:53:45+02:00, Thierry Graff : Creation
    -->
</head>

<body>
<div class="container">

<div class="main">

<nav class="prevnext">
    <a class="top" href="index.html">&uarr;</a>
    <a class="prev" rel="prev" href="cura.html">&larr;</a>
    <a class="next" rel="next" href="cura-D6.html">&rarr;</a>
</nav>

<header>
<h1>Cura - serie A</h1>
<div class="intro">
Accoding to cura.free.fr :
<div class="padding-left">
A1 contains 2088 sports champions
<br>A2 contains 3644 scientists and medical doctors
<br>A3 contains 3047 military men
<br>A4 contains 1473 painters and 1249 French musicians
<br>A5 contains 1409 actors and 1003 politicians
<br>A6 contains 2027 writers and journalists
</div>
<br>This page describes the corrections done on files A1 to A6 while converting html pages to csv files.
<br>The main problems with these files are :
<ul>
    <li>Reconstitute the names.</li>
    <li>Restore legal birth times.</li>
</ul>
</div>
</header>

<article>
<nav class="toc">
    <ul>
        <li>
            <a href="#before-starting">Before starting</a>
            <ul>
                <li><a href="#1-1-prepare-ertel-and-muller">Prepare Ertel and Müller</a></li>
            </ul>
        </li>
        <li>
            <a href="#full-execution">Full execution</a>
        </li>
        <li>
            <a href="#raw2csv">raw2csv</a>
            <ul>
                <li><a href="#3-1-profession-codes">Profession codes</a></li>
                <li><a href="#3-2-name-restoration">Name restoration</a></li>
                <li><a href="#3-3-small-errors">Small errors</a></li>
            </ul>
        </li>
        <li>
            <a href="#tweak2csv">tweak2csv</a>
        </li>
        <li>
            <a href="#better-a1-names-with-ertel4391">Better A1 names with ertel4391</a>
        </li>
        <li>
            <a href="#better-a2-days-and-names-with-muller1083">Better A2 days and names with muller1083</a>
        </li>
        <li>
            <a href="#legaltime">legalTime</a>
        </li>
        <li>
            <a href="#better-a1-names-and-place-with-gauquelin-1955">Better A1 names and place with Gauquelin 1955</a>
            <ul>
                <li><a href="#8-1-names">Names</a></li>
                <li><a href="#8-2-places">Places</a></li>
            </ul>
        </li>
        <li>
            <a href="#addgeo">addGeo</a>
        </li>
    </ul>
</nav>





<!-- ********************************************************************************* -->
<h2><a name="before-starting">Before starting</a></h2>

Raw files must have been downloaded, see <a href="cura.html#download-cura-data">Cura page</a>.

<!-- ************************************* -->
<h3><a name="1-1-prepare-ertel-and-muller">Prepare Ertel and Müller</a></h3>
The restoration of A2 and E1 uses Arno Müller's file 1083 MED ; restoration of A1 uses Ertel's file 4091SPO.
<br>Generation of these files must be done BEFORE restoration process of A1, A2 and E1.
<br>So before working on Cura files, the following commands must have been issued :
<pre>
php run-g5.php newalch ertel4391 all
php run-g5.php newalch muller1083 all
</pre>

See pages <a href="newalch-ertel4391.html">Ertel 4391</a> and <a href="newalch-muller1083.html">Müller 1083</a> for details.


<!-- ********************************************************************************* -->
<h2><a name="full-execution">Full execution</a></h2>
Once this is done, the full set of transformations for all Cura files can be executed with the command :  
<pre>php run-g5.php cura A all</pre>
This is equivalent to :
<pre>
php run-g5.php cura A raw2csv small
php run-g5.php cura A tweak2csv
php run-g5.php newalch ertel4391 fixA1 update
php run-g5.php newalch muller1083 fixCura A2 names update
php run-g5.php newalch muller1083 fixCura A2 days update
php run-g5.php cura A legalTime
php run-g5.php g55 570SPO edited2cura place update
php run-g5.php g55 570SPO edited2cura name update
php run-g5.php cura A addGeo small
php run-g5.php cura A export
</pre>

Each command can be done on individual files ; for example :
<pre>php run-g5.php cura A3 all</pre>
executes all steps on file A3 only.
<br>or :
<pre>php run-g5.php cura A5 raw2csv small</pre>
executes step <code>raw2csv</code> on file A5 only.


<!-- ********************************************************************************* -->
<h2><a name="raw2csv">raw2csv</a></h2>

This command needs a parameter to indicate what it should print :
<pre>php run-g5.php cura A raw2csv</pre>
<pre>
MISSING PARAMETER : raw2csv needs a parameter to specify which output it displays. Can be :
  small : echoes only global results
  full : prints the details of problematic rows
</pre>

<!-- ************************************* -->
<h3><a name="3-1-profession-codes">Profession codes</a></h3>
In some files of serie A, the precise profession codes are not associated to the records. This is possible to fix thanks to the notices that are present on cura.free.fr pages.
<br>These informations were included to the program (see constant <code>PROFESSIONS_DETAILS</code> in <code>rax2csv</code> code) and in the resulting csv files, each record is associated to its precise profession.
<br>
<br><a href="output-format.html#occupation-codes">Page "output format"</a> contains a list of profession codes used in the generated files.


<!-- ************************************* -->
<h3><a name="3-2-name-restoration">Name restoration</a></h3>
The purpose is to obtain records containing both precise birth data and the name of the person.
<br>To summarize, this can be partially done by program from cura.free.fr web pages ; some cases can be fixed by human using Gauquelin 1955 book.
<br><code>raw2csv</code> matching could be bettered for some cases, using newalchemypress.com data. See below, paragraphs <a href="#use-ertel-4391">Use Ertel 4391</a> and <a href="#use-muller-1083">Use Müller 1083</a>.
<br>
<br>Page of serie A contain 3 lists :
<ul class="simple">
    <li>One list with precise birth data, but without names.</li>
    <li>Two lists with names, but without precise birth data ; these two lists are sorted differently. I supposed (but didn't check by program) that these two lists are equivalent.</li>
</ul>

A check done by program (<code>build/check-serieA-names.php</code>) shows that list with precise birth data differ from lists with names (lists with names contain less persons), and can't be used for a simple merge.

<!-- ****************** -->
<h4>Merge lists</h4>

The program must merge the two lists. Unfortunately, these 2 lists don't share a common unique identifier which would permit to merge without ambiguity.
<br>These two lists have in common the birth day. This was used to perform the merge, but a given birth day can correspond to several persons. In this case, ambiguity remains, and can't be solved by program.
<br>
<br>To solve some ambiguities, Gauquelin 1955 book was used in an iterative process :
<ul class="simple">
    <li>Build two arrays with birth day as key.</li>
    <li>Merge the clear cases, with only one person for a given day.</li>
    <li>Print the ambiguous cases.</li>
    <li>Look in Gauquelin 1955 book if the ambiguous persons are present.</li>
    <li>Inject the information in the program (see constant <code>CORRECTIONS_1955</code> in <code>rax2csv</code> code).</li>
    <li>Execute again.</li>
</ul>
Corrections using Gauquelin 1955 are currently done for files A1 and A2.
<br>
<br>For the cases that could not be solved, a name like "Gauquelin-A1-1352" was built, using file name and NUM field.
<br>
<br>The results of this name matching are :

<table class="wikitable margin">
    <th>Serie</th><th>OK</th><th>Not OK</th>
    <tr>
        <td>A1</td>
        <td>1968 (94.3 %)</td>
        <td>119 (5.7 %)</td>
    </tr>
    <tr>
        <td>A2</td>
        <td>3436 (94.32 %)</td>
        <td>207 (5.68 %)</td>
    </tr>
    <tr>
        <td>A3</td>
        <td>2640 (86.67 %)</td>
        <td>406 (13.33 %)</td>
    </tr>
    <tr>
        <td>A4</td>
        <td>2486 (91.4 %)</td>
        <td>234 (8.6 %)</td>
    </tr>
    <tr>
        <td>A5</td>
        <td>2184 (90.62 %)</td>
        <td>226 (9.38 %)</td>
    </tr>
    <tr>
        <td>A6</td>
        <td>1262 (62.29 %)</td>
        <td>764 (37.71 %)</td>
    </tr>
    <tr>
        <td>TOTAL</td>
        <td>13 976 (87.72 %)</td>
        <td>1956 (12.28 %)</td>
    </tr>
</table>


<!-- ************************************* -->
<h3><a name="3-3-small-errors">Small errors</a></h3>

<!-- ****************** -->
<h4>902gdA1y.html</h4>

<ul class="spaced">
    <li>
        in page <code>902gdA1y.html</code>, there is an incoherence between the two lists for one record :
        <pre>1817	3	25	C	185	F	5	16	24	0	48N 0	4W 6	29	CONCARNEAU</pre>
        and
        <pre>1817	3	5	Lebris Jean</pre>
        <a href="img/acts/lebris-jean-1817-03-25.jpg">Birth certificate</a> permits to solve the case. Found on <a href="http://mnesys-portail.archives-finistere.fr/?id=recherche_etat_civil">online civil registry</a> :
        <br>Registre  1 MI EC 53/10 Naissances, p 377 / 559 => Né le 25 mars 1817 à 5h du matin.
        <br>From "Traité de l'heure dans le monde", TU = HLO ;  4°6' = 00:16:24 => hour = 05:16:24
        <br>The first line is exact, the second line must be replaced by
        <pre>1817	3	25	Lebris Jean</pre>
        This fix is included in the code of <code>raw2csv</code>.
    </li>
</ul>

<!-- ****************** -->
<h4>NUM with exclamation marks</h4>

Some records of serie A have a ! in their NUM :
<pre>
A1 : 909 1876
A2 : 2641
A4 : 159 320 439 1350 1443 1480 2136 2312
A5 : 1435 1557 1813 1829 2349 
A6 : 15 139 148 225 232 265 448 574 622 668 718 727 737 738  
</pre>
This information was not included in the generated files because I couldn't find its meaning.


<!-- ********************************************************************************* -->
<h2><a name="tweak2csv">tweak2csv</a></h2>

<pre>php run-g5.php cura A tweak2csv</pre>
Contains human fixes, see <a href="tweak2csv.html">page tweak2csv</a>.
<br>Informations of these yaml files could be used directly by <code>raw2csv</code>, but for the moment it is performed after.


<!-- ********************************************************************************* -->
<h2><a name="better-a1-names-with-ertel4391">Better A1 names with ertel4391</a></h2>
The command :
<pre>php run-g5.php newalch ertel4391 fixA1 update</pre>
permits to restore 100 % of names not identified by step <code>raw2csv</code> in A1.
<br>See <a href="newalch-ertel4391.html#integration-to-g5">page on Ertel 4391</a>, paragraph "Fix cura A1 names".
<br>
<br>NB : <code>raw2csv</code> leaves 118 names unidentified and this step restores 117. This is because one name is handled by step <code>tweak2csv</code>.

<!-- ********************************************************************************* -->
<h2><a name="better-a2-days-and-names-with-muller1083">Better A2 days and names with muller1083</a></h2>

Arno Müller's file of 1083 medical doctors is used to better names and birth days in A2.
<br>This permits to fix only 12 unidentified names in A2.
<br>See <a href="newalch-muller1083.html#integration-to-g5">page on Müller 1083</a>, paragraphs "Fix Cura names" and "Fix Cura days".


<!-- ********************************************************************************* -->
<h2><a name="legaltime">legalTime</a></h2>

<div><div class="inline-block border margin padding">This step is bugged and incomplete</div></div>

The command :
<pre>php run-g5.php cura A legalTime</pre>
adds a column <code>DATE_C</code> (= date corrected) to the generated files.
<br>Example for record A2-1 (Joseph Jean Abadie), 
<br><code>DATE = 1873-12-15 15:59:40+00:00</code> : information from cura.free.fr unchanged
<br><code>DATE_C = 1873-12-15 16:04+00:05:03</code> : time is modified and timezone offset (+00:05:03) is added.
<br>
<br>Here a bug appears, the legal birth time is probably 16:00, not 16:03. For dates prior to 1891-03-15, timezone offset computation involves longitude and equation of time.

<br>
<br>Restoration rates are low :
<pre>
A1 : restored 1029 / 2087 dates (49.31 %)
A2 : restored 1614 / 3643 dates (44.3 %)
A3 : restored 1003 / 3046 dates (32.93 %)
A4 : restored 2333 / 2720 dates (85.77 %)
A5 : restored 882 / 2410 dates (36.6 %)
A6 : restored 776 / 2026 dates (38.3 %)
</pre>

Current code performs restoration only for persons born in France, excluding all cases that can't be fixed by program without ambiguity (ambiguity comes from world wars 1 and 2, for parts of France that were invaded by Germany ; precise timezone offset depend on local conditions).

This can be bettered by implementing non-ambiguous cases for other countries present in A files.


<!-- ********************************************************************************* -->
<h2><a name="better-a1-names-and-place-with-gauquelin-1955">Better A1 names and place with Gauquelin 1955</a></h2>

The restoration of 1955 group "570 sportifs" is used to better family and given names as well as place names in file A1.
<br>This step must be performed after <code>newalch ertel4391 fixA1</code>, as name spelling in Gauquelin 1955 book is better, and after <code>legalTime</code>.
<br>
<br>The corrections use the columns added for human corrections of files in <code>3-g55-edited/</code> (these column names end with <code>_55</code>). Other columns of these files are not used. The reason is that once a file located in <code>3-g55-edited/</code> is edited by a human, it is never updated by program again. So the columns generated by program may contain obsolete information (in fact they do, because the file <code>3-g55-edited/570SPO.csv</code> was generated before writing commands that add corrections).

<!-- ************************************* -->
<h3><a name="8-1-names">Names</a></h3>

The command
<pre>php run-g5.php g55 570SPO edited2cura name list</pre>
lists the differences between names of Cura A files and Gauquelin 1955 groups.
<br>Random checks, comparing the names with wikipedia and other sources, show that Gauquelin names are globally better than Cura names (but Gauquelin 1955 names also contain errors).
<!--  - these are handled by the <code>finalize-csv</code> step of cura csv generation, see <a href="cura-A.html">the page about serie A</a> -->


<pre>php run-g5.php g55 570SPO edited2cura name update</pre>
is used to copy the contents of columns <code>GIVEN_55</code> and <code>FAMILY_55</code> to the files of <code>5-cura-csv/</code>.
<br>
<br>This command updates 59 names in file <code>A1</code>.

<!-- ************************************* -->
<h3><a name="8-2-places">Places</a></h3>
Gauquelin 1955 place names are generally better than Cura places.

<br>This works like names :
<pre>php run-g5.php g55 570SPO edited2cura place list</pre>
<pre>php run-g5.php g55 570SPO edited2cura place update</pre>


<!-- ********************************************************************************* -->
<h2><a name="addgeo">addGeo</a></h2>
This command needs a parameter to indicate what it should print :
<pre>php run-g5.php cura A1 addGeo</pre>
<pre>
WRONG USAGE - This command needs a parameter indicating the type of report
- full : lists all the place names that can't be matched to geonames.
- medium : lists the places with several matches to geonames.
- small : only echoes global information about matching.
</pre>

It modifies records of <code>5-cura-csv/</code> only if there is a unique match to geonames.
<br>In case of match, fills column <code>GEOID</code>, and updates column <code>PLACE</code> (because place names in geonames are generally better).

</article>
</div><!-- end class="main" -->


<!-- ************************************* -->
<aside class="left">                                                                                                                                              
<ul>
    <li class="bold big1"><a href="index.html">g5 Doc</a></li>
    <li class="bold big1"><a href="https://github.com/tig12/gauquelin5">g5 code</a></li>
    <li><a href="organisation.html">Organisation</a></li>
    <li><a href="usage.html">Program usage</a></li>
    <li><a href="output-format.html">Output format</a></li>
    
    <li>
        <span class="big1">1 - Restore</span>
        <ul>
            
            <li><a href="cura.html">cura.free.fr</a></li>
            
            <li>
                <ul>
                    <a href="cura-A.html">A</a>
                    <a href="cura-D6.html">D6</a>
                    <a href="cura-D10.html">D10</a>
                    <a href="cura-E1-E3.html">E1 E3</a>
                <li><a href="cura-results.html">Results</a></li>
                </ul>
            </li>
            
            <li>
                <a href="newalch.html">newalchemypress.com</a>
                <ul>
                    <li><a href="newalch-ertel4391.html">Ertel 4391 SPO</a></li>
                    <li><a href="newalch-muller1083.html">Müller 1083 MED</a></li>
                </ul>
            </li>
            
            
            <li>
                <a href="g55.html">Gauquelin 1955</a>
                <ul>
                    <li><a href="g55-restore.html">Restoration</a></li>
                    <li><a href="g55-curadiff.html">Differences with Cura</a></li>
                </ul>
            </li>
            
            <li><a href="comite-para.html">Comité Para 1976</a></li>
            <li><a href="csicop.html">CSICOP 1979</a></li>
            <li><a href="cfepp.html">CFEPP 1996</a></li>
            
        </ul>
    </li>
    
    <li>
        <span class="big1">2 - Build new data</span>
        <ul>
            <li><a href="full.html">7-full/</a></li>
            <li><a href="data-model.html">Data model</a></li>
            <li><a href="check.html">Check data</a></li>
            <li><a href="merge.html">Merge data</a></li>
            <li><a href="wikidata.html">Wikidata.org</a></li>
            <li><a href="geonames.html">Geonames.org</a></li>
        </ul>
    </li>
        
    <li>
        <span class="big1">3 - Eminence</span>
        <ul>
            <li><a href="eminence.html">Eminence ranking</a></li>
        </ul>
    </li>
    
    
    <li><a href="code-details.html">Code details</a></li>
    <li><a href="time.html">Expressing time</a></li>
    <li><a href="tweak2csv.html">tweak2csv</a></li>
    
    <!-- <li><a href="next.html">Next</a></li> -->
    
    <!-- <li><a href="questions.html">Questions</a></li> -->
    
    <li>
        Doc
        <ul>
            <li><a href="historical-tests.html">List of historical tests</a></li>
        </ul>
    </li>
    
    <li class="bold big1"><a href="https://larzac.info/gauquelin5">Download results</a></li>
    
</ul>
</aside>

</div><!-- end class="container" -->

</body>
</html>
<!-- ************************************* -->
<!-- ********************************************************************************* -->
