<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>From scratch | Gauquelin5</title>
    <link href="static/gauquelin5.css" rel="stylesheet" type="text/css">
    <meta name="description" content="Configure and start using Gauquelin5 software">
    <meta name="robots" content="index,follow">
    <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
    <meta name="dcterms.rights" content="Creative commons by-sa 4.0">
    <meta name="dcterms.rightsHolder" content="Thierry Graff">
    <meta name="dcterms.dateCopyrighted" content="2019">
    <!-- 
    tigsite:
        history: 2019-04-01 00:20:27+02:00, Thierry Graff : Creation
    -->
</head>

<body>
<div class="container">

<div class="main">

<nav class="prevnext">
    <a class="top" href="index.html">&uarr;</a>
    <a class="prev" rel="prev" href="output-format.html">&larr;</a>
    <a class="next" rel="next" href="1-cura-data.html">&rarr;</a>
</nav>

<header>
<h1>Gauquelin5 from scratch</h1>
<div class="intro">Configure and start using Gauquelin5 software.</div>
</header>

<article>

This software has been developed and tested under Linux (Ubuntu 18.4), using php 7.2.
A priori, it should also work under Windows and Macintosh.
<br>
<br>It is used through the command line.

<!-- ********************************************************************************* -->
<h2>Installation</h2>
Open a terminal and clone the repository on your local machine :
<pre>git clone https://github.com/tig12/gauquelin5</pre>

PECL extension "yaml" must be installed.
<br>On debian-based systems :
<pre>sudo apt install php-yaml</pre>
For other systems, see <a href="https://www.php.net/manual/en/install.pecl.php">php manual</a>.

<h3>Directory structure</h3>
The important files and directories are :
<pre>
gauquelin5/
    ├── build/
    ├── config.yml.dist
    ├── data/
    │   ├── 1-raw/
    │   ├── 3-edited/
    │   ├── 5-tmp/
    │   └── 9-output/
    ├── docs/
    ├── run-g5.php
    ├── share/
    ├── src/
    └── vendor/
</pre>

In the rest of this doc, directory <code>gauquelin5/</code> is called the <b><i>root directory</i></b>.
<br>If not specified, all the commands issued to run the program are done from the root directory.
<br>
<br>The files you need to know about are :
<ul class="simple">
    <li><code><b>run-g5.php</b></code> is the entry point to use the program.</li>
    <li><code><b>data/</b></code> contains the data generated and manipulated by the program (see below).</li>
    <li><code><b>config.yml.dist</b></code> needs to be copied (see below).</li>
</ul>

<!-- ********************************************************************************* -->
<h2>Configuration</h2>
Create a file <code>config.yml</code> by copying <code>config.yml.dist</code> :
<pre>cp config.yml.dist config.yml</pre>

Edit <code>config.yml</code> and adapt some values :

<!-- ************************************* -->
<h3>dirs</h3>
This directive permits to specify the different directories used by the program to store the data it manipulates.
<br>The values can contain either absolute paths or paths relative to root directory.
<br>Default values are all relative to root directory :
<pre>
dirs:
  1-cura-raw:           data/1-raw/cura.free.fr
  1-newalch-raw:        data/1-raw/newalchemypress.com
  # etc.
</pre>

If you look at <code>data/</code> directory, you will see that it contains only one sub-directory : <code>3-edited/</code>.
<br>This is because this directory contains human corrections, <i>and is versioned with the program</i>.
<br>The other directories contain data generated by program or copied from the internet, and are not versioned. So if you want to use them, you must create yourself these directories.
<br>See below for details about <code>data/</code> directory.


<!-- ************************************* -->
<h3>geonames.org and postgresql</h3>
To restore place names and timezones, the program uses geonames.org ; these two sections are related to geonames, <a href="geonames.html">see this page</a> for details.

<!-- ************************************* -->
<h3>Other directives</h3>
<code>config.yml</code> contains other directives, specific to particular steps of the program. These directives are explained in the pages corresponding to these steps.


<!-- ********************************************************************************* -->
<h2>Data directory</h2>

Data manipulated by the program are divided in 3 distinct groups :
<ul class="spaced margin-top margin-bottom">
    <li>
        <b>Raw data</b> are input data, stored by default in <code>data/1-raw</code>.
    </li>
    <li>
        <b>Intermediate data</b> are separated in two directories :
        <br><code>data/3-edited</code> contains files with human corrections.
        <br><code>data/5-tmp</code> contains data generated by the program.
        <br>This distinction was made to prevent accidental erasure of human correction.
        <br>The rule is that the program never generates data in <code>data/3-edited</code>.
        <br>If a generated file needs human corrections, the it is copied manually in <code>data/3-edited</code> directory.
        <br>Data located in <code>data/5-tmp</code> can be safely erased by new program execution.
    </li>
    <li>
        <b>Output data</b>, stored by default in <code>data/9-output</code>, are the "final" data generated by the program, to be downloaded.
        <br>This directory is currently empty as the steps generating its data are not written yet.
    </li>
</ul>

<code>data/3-edited</code> is the only data that are versioned with the program.
<br>You can retrieve the other data in your local machine with the command :
<pre>
wget
</pre>


<!-- ********************************************************************************* -->
<h2>Gauquelin5 usage</h2>

To check that the program works, type :
<pre>php run-g5.php</pre>
A message saying that you must provide supplementary arguments is displayed.
<pre>
WRONG USAGE - need at least 3 arguments
-------
Usage : 
    php run-g5.php &lt;dataset> &lt;datafile> &lt;action> [parameters]
with :
    &lt;dataset> can be : cura, g55, mactutor, newalch, wd
    &lt;datafile> : the precise file(s) within the dataset.
    &lt;action> = action done on data ; available actions depend on dataset and datafile.
    [parameters] optional list of parameters depending on action.
Example :
    php run-g5.php cura A2 raw2csv
-------
Try with one of these datasets : cura, g55, mactutor, newalch, wd
</pre>

The program uses 3 notions :
<ul>
    <li>
        <span class="bold">dataset</span> : groups data coming from the same information source.
    </li>
    <li>
        <span class="bold">datafile</span> : represents one or several files contained in a dataset.
    </li>
    <li>
        <span class="bold">action</span> : represents a treatment done on a datafile.
    </li>
</ul>

<br>Each time an incomplete command is given to the program, it prints the general error message and prints the possible values for the next missing argument.
<br>
<br>Example 1
<pre>php run-g5.php cura</pre>
<pre>
WRONG USAGE - need at least 3 arguments
... (general message) ...
Possible datafiles for dataset cura : all, A, A1, A2, A3, A4, A5, A6, D6, D10, E1, E3
</pre>

Example 2
<pre>php run-g5.php cura A3</pre>
<pre>
WRONG USAGE - need at least 3 arguments
... (general message) ...
Possible actions for cura - A3 : all, csv2full, ertel2csv, raw2csv, restoreTime
</pre>

Example 3
<pre>php run-g5.php cura A3 raw2csv</pre>
This does a real transformation (converts A3 raw html file to a csv file).
<br>
<br>Precise commands are described in the following pages.
</article>
</div><!-- end class="main" -->


<!-- ************************************* -->
<aside class="left">
<ul>
    <li class="bold"><a href="index.html">Gauquelin5 home</a></li>
    <li><a href="why.html">Why ?</a></li>
    <li class="bold"><a href="summary-chart.html">Summary chart</a></li>
    <li class="bold"><a href="output-format.html">Output format</a></li>
    
    <li><a href="0-from-scratch.html">0 - From scratch</a></li>
    <li>
        <a href="1-cura-data.html">1 - Cura data</a>
    </li>
    <li>
        <a href="2-cura2csv.html">2 - Cura to csv</a>
        <div class="padding-left">
            <a href="2-serieA.html">A</a>
            <a href="2-serieD6.html">D6</a>
            <a href="2-serieD10.html">D10</a>
            <a href="2-serieE1-E3.html">E1 E3</a>
        </div>
    </li>
    <li>
        <a href="3-mark.html">3 - Mark data</a>
    </li>
    <li>
        <a href="4-1955-corrections.html">4 - Corrections from G1955</a>
    </li>
    <li>
        <a href="ertel4391.html">Ertel 4391</a>
    </li>
    <li class="bold">
        <a href="results.html">Results</a>
    </li>
    <li><a href="time.html">Expressing time</a></li>
    <li><a href="geonames.html">Geonames.org</a></li>
    <li><a href="wikidata.html">Wikidata.org</a></li>
    <li><a href="code-details.html">Code details</a></li>
    <!-- <li><a href="questions.html">Questions</a></li> -->
    <li><a href="next.html">What's next</a></li>
    <li class="bold"><a href="https://larzac.info/gauquelin5">Download</a></li>
    <li class="bold"><a href="https://github.com/tig12/gauquelin5">Github repo</a></li>
</ul>
</aside>

</div><!-- end class="container" -->

</body>
</html>
<!-- ************************************* -->
<!-- ********************************************************************************* -->
